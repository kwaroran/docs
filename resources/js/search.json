[[{"l":"Introduction","p":["RisuAI, shortly Risu is a frontend or a platform with powerful features like Multiple API supports, Assets on chat, Regex functions and more.","Here, you can find the documentation for RisuAI. This documentation is a work in progress. To use RisuAI, visit RisuAI website. To contribute to this documentation, visit Github Repository"]}],[{"i":"making-bots-basic","l":"Making Bots (Basic)","p":["In this section,"]},{"l":"Creating from scratch","p":["To create your character from scratch,","press + button in the left pannel, press \"create from scratch\"","switch to \"character\" pannel","Set the name of your character. we recommend to be short, otherwise it cause bad influence to AI.","Set the description of the character. we recommend something like this format:","Set the first message, also known as greeting. do not put user's move or speech here, otherwise it cause bad influence to AI.","Go to the character display screen, which you can go by pressing button.","Set the character's image, and you are done!"]}],[{"l":"Common Errors","p":["Work in progress."]}],[{"l":"Basics","p":["On the basics tab you can set the basic information about your character."]},{"l":"Character Name","p":["The name of your character. This is the name that will be displayed in and used. This name would used by AI very often, so make sure to choose a name that is easy to remember and pronounce.","It is recommended to use a short name rather than a full name. putting a full name can confuse AI and make it harder to remember. like \"John\" instead of \"John Doe\". put a full name in the description section instead if you want."]},{"l":"Character Description","p":["A description of your character. Write short or long description of your character. The description would be used by AI every time. It is recommended to write in a way that AI can understand better. For example:","for detailed description, it is recommended to use Lorebooks."]},{"l":"First Message","p":["First message that would appear when you start a conversation with your character.","First message is important for AI, because it sets the tone of the conversation and helps AI to understand the character better."]},{"i":"authors-note","l":"Author's Note","p":["A note that would AI would consider very importantly. It is recommended to write a note that how the conversation should go, if you want to make AI to follow a specific path. for example: John will go to the park and meet his friend.","Author's note is chat-dependent, not character-dependent. So, you can write different notes for different chats. and it wouldn't be exported with the character."]}],[{"l":"Character Display","p":["On Character Display tab you can set the character icon and additional character screen settings."]},{"l":"Character Icon","p":["On Character Icon section you can set the character icon. The character icon is the image that would be shown on the chat window. By default, the character icon is 1:1 aspect ratio, but you can change to 2:3 aspect ratio by checking the \"Protrait\" checkbox."]},{"l":"Additional Character Screen","p":["Additional Character Screen is where you can put character's image on additional screen or inlay."]},{"l":"Modes","p":["There are two modes for Additional Character Screen. \"Emotion Image\" and \"Image Generation\"."]},{"l":"Emotion Image","p":["If you set the mode to Emotion Images, the character image would be shown next to the text window. the character image would change dynamicly, depending on the conversation.","How the emotion image works is, you can set it at the Emotion Image tab at the global settings.","You can add character images on bottom of the emotion image menu. the image must have a emotion name. the emotion name is used on choosing the image, so write it carefuly.","if the emotion name is neutral, it would be set as default image."]},{"l":"Image Generation","p":["If you set the mode to Emotion Images, the ai-generated image would be shown next to the text window. the character image would be generated every time, depending on the conversation. To use it, you must set up the image generation settings to work. image generation settings is on the other bot tab, on the global settings.","Image Generation Prompt is the prompt for image generation. {​{slot}​} would be replaced with ai's response, Image Generation Negative Prompt is the prompt for image generation. {​{slot}​} does nothing here, and Image Generation Instructions is a prompt which would sent to ai to generate {​{slot}​} for Image Generation Prompt."]},{"l":"Inlay Screen","p":["If you turn on Inlay Screen checkbox, the images would be put in screen. and this would make ai to select or generate image at the same time when they generate, which can make the result more accurate."]}],[{"l":"Lorebook","p":["Lorebooks are collection of lore entries. Each entry is a piece of prompt that would be sent to the AI model. unlike character description, lore entries can use advanced conditions, mainly activation by keywords.","Lorebooks can be embeded to characters, or chats, or even modules."]},{"l":"Structure"},{"l":"Name","p":["The name of the lorebook. This is used to identify the lorebook in the character configuration. this doesn't effect the AI's response, just for identification."]},{"l":"Activation Keys","p":["Activation keys are the keywords that would activate the lore entry. The AI would only respond to the lore entry if the activation keys are present in the chat messages. The activation keys are separated by commas."]},{"l":"Insertion Order","p":["The order of the lore entries in the lorebook. If the order is higher, the lore entry would be inserted more later in the context, which would make the AI to consider the lore entry more important. It would also effect the removal of the lore entry if the lore entry is too much. in that case, the lore entries with lower order would be removed first."]},{"l":"Prompt","p":["The prompt that would be sent to the AI model. If the lore entry is activated, this prompt would be sent to the AI model to generate the response."]},{"l":"Always Active","p":["If this is enabled, the lore entry would be always active, regardless of the activation keys. This is useful for the lore entries that should be always active."]},{"l":"Selective","p":["If this is enabled, the secondary activation keys would appear, and it would also require the secondary activation keys to activate the lore entry."]},{"l":"Use Probability Condition","p":["If this is enabled, the lore entry would only be activated on certain probability. This is useful for the lore entries that should be activated randomly."]},{"l":"Settings"},{"l":"Recursive Scanning","p":["If this is enabled, the AI would also scan the lore entries' prompts for the activation keys."]},{"l":"Full Word Matching","p":["If this is enabled, the AI would only consider the activation keys if they are full words. for example, if the activation key is cat, the AI would only consider the activation key if the word is cat, not caterpillar."]},{"l":"Lorebook Search Depth","p":["The depth of the lorebook search. The AI would only consider only recent Lorebook Search Depth chats for the activation keys. We recommend to keep this value by default, if you don't know what you are doing."]},{"l":"Lorebook Max Tokens","p":["The maximum tokens that the all lore entries' prompts can have. If the lore entries' prompts have more tokens than this value, the lore entries would be removed, starting from the lore entries with lower Insertion Order."]},{"l":"Decorators","p":["Decorators are advanced conditions, or effects that can be applied to the lore entries. The decorators should be provided at the Prompt field, and should be started with @@.","Example:"]},{"i":"depth-n","l":"@@depth N","p":["If this decorator is provided, the AI would put the response of the lore entry at the depth of N. This is useful for the lore entries that should be considered more important."]},{"i":"activate_only_after-n","l":"@@activate_only_after N","p":["If this decorator is provided, the AI would only activate the lore entry after the Nth chat message. This is useful for the lore entries that should be activated after certain conditions."]},{"i":"activate_only_every-n","l":"@@activate_only_every N","p":["If this decorator is provided, the AI would only activate the lore entry every Nth chat message. This is useful for the lore entries that should be activated periodically."]},{"i":"reverse_depth-n","l":"@@reverse_depth N","p":["If this decorator is provided, the AI would put the response of the lore entry at the reverse depth of N. This is useful for the lore entries that should be considered less important."]},{"i":"role-a","l":"@@role A","p":["If this decorator is provided, the AI would consider the lore entry as the role of A. This is useful for the lore entries that should be considered as the role of A. roles can be user, system or assistant."]},{"i":"scan_depth-a","l":"@@scan_depth A","p":["If this decorator is provided, the AI would scan the lore entry for the activation keys at the depth of A, regardless of the Lorebook Search Depth. This is useful for the lore entries that should be activated at the certain depth."]},{"i":"is_greeting-n","l":"@@is_greeting N","p":["If this decorator is provided, the AI would consider the lore entry as the greeting of index N."]},{"i":"position-a","l":"@@position A","p":["If this decorator is provided, the AI would consider the lore entry as the position of A. positions can be personality, scenario or pt_name. pt_name is the position of that is provided in prompt template."]},{"i":"ignore_on_max_context","l":"@@ignore_on_max_context","p":["If this decorator is provided, the AI would ignore the lore entry if the context is full."]},{"i":"additional_keys-abc","l":"@@additional_keys A,B,C...","p":["If this decorator is provided, the AI would consider the lore entry as additional keys of A, and it would also require one of the additional keys to activate the lore entry."]},{"i":"exclude_keys-abc","l":"@@exclude_keys A,B,C...","p":["If this decorator is provided, the AI would consider the lore entry as exclude keys of A, and it would not activate the lore entry if one of the excluded keys is present."]},{"i":"probability-n","l":"@@probability N","p":["If this decorator is provided, the AI would only be activated on the probability of N%. This is useful for the lore entries that should be activated randomly."]},{"i":"activate","l":"@@activate","p":["If this decorator is provided, the AI would activate the lore entry, regardless of all other conditions."]},{"i":"dont_activate","l":"@@dont_activate","p":["If this decorator is provided, the AI would not activate the lore entry, regardless of all other conditions."]}],[{"l":"Scripts","p":["For scripts, checkout the About Scripts, Regex Script and Trigger Script pages."]}],[{"l":"TTS","p":["TTS (Text to speech) makes character's response to a speech. the TTS settings (excluding API keys) are embeded to the character, making shared characters to have the same TTS settings."]},{"l":"Providers","p":["These are the TTS providers that are supported by RisuAI. Some of them requires an API key to use, and you must provide the API key in Other Bots settings."]},{"l":"Web Speech","p":["Web Speech is the most accessible TTS, which is provided by the browser. It is supported by most of the modern browsers. It is free, and doesn't require any API key. However, it has some limitations:","It doesn't support all the languages.","The voice quality is not good.","Voice varys between the browsers."]},{"l":"ElevenLabs","p":["ElevenLabs is a TTS provider that provides high quality voices. It requires an API key to use. It supports many languages, and has high quality voices, however, its expensive. You can get the API key from ElevenLabs"]},{"l":"OpenAI","p":["OpenAI also provides TTS service. It requires an API key to use. However, OpenAI's TTS is not as good, since:","The variety of voices are very limited.","Customization is limited.","However, If you already have an OpenAI API key, you can just simply use it for the TTS too, making it easier to use."]},{"l":"NovelAI","p":["NovelAI also provides TTS service. It requires an API key to use. you can also use custom voice seed, which would make the voice more unique. To get a NovelAI API key, see NovelAI API Key Guide"]},{"l":"Hugging Face","p":["Hugging Face also provides TTS service. It requires an API key to use. It has many voices, and supports many languages. To get a Hugging Face API key, see Hugging Face API Key Guide"]},{"l":"VITS","p":["You can use your own VITS model to generate the TTS, directly in the client, without any API key. to setup, first, get a VITS model, in hugging face format, and zip it as model.zip. then, upload the model pressing Select Model button.","VITS models are embeded to the character, making shared characters to have the same VITS model."]}],[{"l":"Advanced Settings","p":["In Advanced Settings, you can configure powerful settings. however, for beginners, it is recommended to keep the default settings, since it can cause unexpected results."]},{"l":"Example Message","p":["Example messages are the messages that would be sent to the AI model to generate the response. These example message would be provided to the AI model until the context is full.","Here are example-example messages, for character named Haruhi.","START marks the start of the example message, and {{user}} and {{char}} marks the speaker of the message."]},{"i":"creators-comment","l":"Creator's Comment","p":["Creator's comment is the comment, that would be shown on top of the chat, and not sent to the AI model. This is useful for the creators to provide information about the character.","creator's comment can be written in markdown format, and you can use creator's comment for each language."]},{"l":"System Prompt","p":["System prompt is the prompt that would be added as a \"Main Prompt\". However, we DO NOT recommend to use this, since it can cause unexpected results. use Lorebook instead for this purpose."]},{"l":"Global Note Replacement","p":["Global note replacement is the prompt that would be replace \"Global Note\". However, we DO NOT recommend to use this, since it can cause unexpected results. use Lorebook with @@end decorator instead for this purpose."]},{"l":"Additional Description","p":["Additional description is the description that would only be added to the character's description if recent chat's similarity is higher than certain value. the similarity is calculated by the AI model which runs in the client.","Each prompt should be separated by two new lines."]},{"l":"SupaMemory","p":["The SupaMemory section displays current SupaMemory data. You can view and edit the SupaMemory data here. do not edit the SupaMemory data unless you know what you are doing."]},{"l":"Background Embedding","p":["Background embedding is the setting that would embed the background to the chat. It allows HTML tags and Curly Braced Syntaxes to be used in the background."]},{"l":"Creator","p":["Creator field allows you to set the creator of the character. This is useful for the creators to provide information about the character."]},{"l":"Character Version","p":["Character version is the version of the character. This is useful for the creators to provide information about the character."]},{"l":"Depth Prompt","p":["Depth prompt is the prompt that would added in certain depth. the lower the depth, the more important the prompt would be."]},{"l":"Alternative First Messages","p":["Alternative first messages is just like it sounds, a First Message which can be selected by the user. if alternative first messages are provided, the user can select the first message by arrow buttons on the first message."]},{"l":"Utility Bot","p":["If Utility bot field is checked, the character would be considered as a utility bot, which would ignore ALL OF THE GLOBAL PROMPT SETTINGS. This is useful for the characters that should be used as utility bots, or characters that only works well on certain prompts."]}],[{"l":"Chat Bot","p":["On chat bot tab you can set the bot settings. like provider, prompt settings, and other. There is simple settings mode and advanced settings mode, which can be toggled by the switch on top of the page."]},{"l":"Simple Settings","p":["On simple settings mode, there are only few settings that you can set, and the client would handle the rest.","Model: AI model that would be used for the chat. You can select the model that you want to use for the chat.","API Key: API key that would be used for the chat. Some of the models requires an API key to use.","For getting an API key, see API Key Guide"]},{"l":"Advanced Settings","p":["On advanced settings mode, you can configure powerful settings. however, for beginners, it is recommended to keep the simple settings, unless you know what you are doing.","Only a few Provider specific settings are available in this document for now. More will be added later."]},{"l":"Models","p":["There are two types of models that you should set on the advanced settings.","Model: AI model that would be used for the chat.","Auxiliary Model: Auxiliary model that would be used for non-chat purposes, like summarization, emotion detection, etc.","We recommend to keep the auxiliary model to cheap model, since it would be used for non-chat purposes, and it would be more cost-effective. or if you just do not want to care about it, you can just keep it same as the model."]},{"l":"API Key","p":["API key that would be used for the chat, like the simple settings. for getting an API key, see API Key Guide."]},{"l":"Max Context Size","p":["The maximum context size of the AI in tokens. More context would mean AI's more memory, but it would also mean more cost. AI models have hard limit of context size, and if the context size is too big, the AI might throw an error."]},{"l":"Temperature","p":["Temperature is the setting that would control the randomness of the AI's response. The higher the temperature, the more creative the AI would be, but it would also be more chaotic. The lower the temperature, the more predictable the AI would be, but it would also be more boring."]},{"l":"Top P","p":["Top P is the setting that would control the diversity of the AI's response. The higher the Top P, the more diverse the AI would be, but it would also be more chaotic. The lower the Top P, the more predictable the AI would be, but it would also be more boring."]},{"l":"Top K","p":["Top K is the setting that would control the diversity of the AI's response. Unlike Top P, Top K would only consider the top K tokens, and would ignore the tokens that are not in top K. Less Top K would make the AI to be more boring, but more accurate.","If Top K is set to 0, it would be disabled."]},{"l":"Min P","p":["Min P is the setting that would control the diversity of the AI's response. Unlike Top K, Min P uses the probability of the tokens, and would ignore the tokens that are below the Min P. Less Min P would make the AI to be more creative, but more chaotic and vice versa for more Min P."]},{"l":"Top A","p":["Top A is the setting that would control the diversity of the AI's response. Unlike Top K, Top A would only consider the top A tokens, and would ignore the tokens that are not in top A."]},{"l":"Repetition penalty","p":["Repetition penalty is the setting that would control the repetition of the AI's response. The higher the repetition penalty, the less the AI would repeat itself, but it would also be more chaotic. The lower the repetition penalty, the more the AI would repeat itself, but it would also be more boring.","This setting only applies when model does not support Frequency Penalty and Presence Penalty."]},{"l":"Frequency penalty","p":["Frequency penalty is the setting that would control the repetition of the AI's response. The higher the frequency penalty, the less the AI would repeat itself, but it would also be more chaotic. The lower the frequency penalty, the more the AI would repeat itself, but it would also be more boring. The frequency penalty only applies to the tokens that are already in the context."]},{"l":"Presence penalty","p":["Presence penalty is the setting that would control the repetition of the AI's response. The higher the presence penalty, the less the AI would repeat itself, but it would also be more chaotic. The lower the presence penalty, the more the AI would repeat itself, but it would also be more boring. The presence penalty only applies to the tokens that are only in the AI's response."]},{"l":"Auto Suggest","p":["Auto suggest is a prompt that would be sent to the AI model if \"Auto Suggest\" is enabled. The AI model would generate the response based on the prompt, and the response would be shown to the user as a suggestion. The user can select the suggestion by clicking on it."]},{"l":"Bias","p":["Bias is the setting that would control the AI's response. The bias would be added to the AI's response, and it would make the AI to generate the response less or more. The bias can be positive or negative, and it can be a number between -101 and 100. The higher the bias, the more the AI would generate the response, and the lower the bias, the less the AI would generate the response.","If the bias is set to -101, it would work as \"super ban\", and RisuAI would try to avoid generating the response."]},{"l":"Main Prompt","p":["Main prompt is the prompt that would be sent to the AI model. Put main instructions here. main prompt as independent field would be hidden if prompt template setting is enabled."]},{"l":"Jailbreak Prompt","p":["Jailbreak prompt is the prompt that would be sent to the AI model. Put jailbreak instructions here. jailbreak prompt as independent field would be hidden if prompt template setting is enabled."]},{"l":"Global Note","p":["Global note is the prompt that would be sent to the AI model. Put important information here. global note as independent field would be hidden if prompt template setting is enabled."]},{"l":"Formating Order","p":["Formating order is the order of the formating. The formating would be applied in the order of the formating order. formating order would be hidden if prompt template setting is enabled."]},{"l":"Prompt Template","p":["See Prompt Template for more information."]}],[{"l":"Other Bots"},{"l":"Emotion Image"}],[{"l":"Prompt Template"}],[{"l":"About Scripts"}],[{"l":"Regex Scripts"}],[{"i":"trigger-script-lua-mode","l":"Trigger Script (Lua Mode)","p":["On trigger script lua mode, you can write a lua script to handle the trigger event. The script will be executed when the trigger event is triggered."]},{"l":"Callback Function","p":["There are three normal callback functions you can use in the lua script:","onStart(triggerId): This function will be called when chat is sent.","onOutput(triggerId): This function will be called when AI response is received.","onInput(triggerId): This function will be called when user input is received.","For button events (like {{button::Display::TriggerName}}), it calls the function with same name as TriggerName.","You can also use listenEdit(type, callback) to listen for edit events. The type can be editRequest, editDisplay, editInput, and editOutput. The callback function will be callback(triggerId, data)."]},{"l":"Example","p":["The above script will make an alert with the message input received! when user input is received.","The above script will append editDisplay: to the display data.","The above script will make an alert with the message button clicked! when the button {{button::Display::onButton}} is clicked."]},{"l":"Functions","p":["You can use the following functions in the lua script. Every function except log must be called with the triggerId as the first argument for security reasons. you can get the triggerId from the callback function.","All functions except setChatVar, getChatVar, setState, getState, log would not work in editDisplay event."]},{"i":"logmessage","l":"log(message)","p":["Log the message to the console. unlike print, this outputs as a JSON format, making arrays and objects display correctly in the devtools console."]},{"i":"setchatvartriggerid-key-value","l":"setChatVar(triggerId, key, value)","p":["Set a chat variable with the key and value. value must be a string."]},{"i":"getchatvartriggerid-key","l":"getChatVar(triggerId, key)","p":["Get the value of a chat variable with the key."]},{"i":"setstatetriggerid-key-value","l":"setState(triggerId, key, value)","p":["Set a state variable with the key and value. value must be a JSON serializable. (like string, number, boolean, array, object)"]},{"i":"getstatetriggerid-key","l":"getState(triggerId, key)","p":["Get the value of a state variable with the key."]},{"i":"stopchattriggerid","l":"stopChat(triggerId)","p":["Stop the chat. this only works on some trigger events."]},{"i":"alerterrortriggerid-message","l":"alertError(triggerId, message)","p":["Show an error alert with the message."]},{"i":"alertnormaltriggerid-message","l":"alertNormal(triggerId, message)","p":["Show a normal alert with the message."]},{"i":"alertinputtriggerid-message","l":"alertInput(triggerId, message)","p":["Show an input alert with the message, and return the input value."]},{"i":"setchattriggerid-index-message","l":"setChat(triggerId, index, message)","p":["Set the chat message at the index. index starts from 0."]},{"i":"setchatroletriggerid-index-role","l":"setChatRole(triggerId, index, role)","p":["Set the chat role at the index. index starts from 0. role can be user and char."]},{"i":"cutchattriggerid-start-end","l":"cutChat(triggerId, start, end)","p":["Cut the chat message from start to end. start and end are both 0-based index. to cut only one message, use removeChat(triggerId, index)."]},{"i":"removechattriggerid-index","l":"removeChat(triggerId, index)","p":["Remove the chat message at the index. index starts from 0."]},{"i":"addchattriggerid-role-message","l":"addChat(triggerId, role, message)","p":["Add a chat message with the message and role. role can be user and char."]},{"i":"insertchattriggerid-index-role-message","l":"insertChat(triggerId, index, role, message)","p":["Insert a chat message at the index with the message and role. index starts from 0. role can be user and char."]},{"i":"removechattriggerid-index-1","l":"removeChat(triggerId, index)","p":["Remove the chat message at the index. index starts from 0."]},{"i":"getchatlengthtriggerid","l":"getChatLength(triggerId)","p":["Get the chat length."]},{"i":"getfullchattriggerid","l":"getFullChat(triggerId)","p":["Get the full chat message, with the format of:"]},{"i":"setfullchattriggerid-chat","l":"setFullChat(triggerId, chat)","p":["Set the full chat message, with the format of:"]},{"i":"getnametriggerid","l":"getName(triggerId)","p":["Returns the name of the current character."]},{"i":"setnametriggerid-name","l":"setName(triggerId, name)","p":["Set the name of the current character."]},{"i":"getdescriptiontriggerid","l":"getDescription(triggerId)","p":["Returns the description of the current character."]},{"i":"setdescriptiontriggerid-description","l":"setDescription(triggerId, description)","p":["Set the description of the current character."]},{"i":"getcharacterfirstmessagetriggerid","l":"getCharacterFirstMessage(triggerId)","p":["Returns the first message of the current character."]},{"i":"setcharacterfirstmessagetriggerid-message","l":"setCharacterFirstMessage(triggerId, message)","p":["Set the first message of the current character."]},{"i":"getbackgroundembeddingtriggerid","l":"getBackgroundEmbedding(triggerId)","p":["Returns the background embedding of the current character."]},{"i":"setbackgroundembeddingtriggerid-embedding","l":"setBackgroundEmbedding(triggerId, embedding)","p":["Set the background embedding of the current character."]},{"i":"similaritytriggerid-source-value","l":"similarity(triggerId, source, value)","p":["This function requires low level access.","Perform a similarity sort between the source and value. source must be a array of strings, and value must be a string. return a array of index sorted by similarity.","This is a async function. use similarity(triggerId, source, value):await() to wait for the result."]},{"i":"generateimagetriggerid-prompt-negative","l":"generateImage(triggerId, prompt, negative)","p":["This function requires low level access.","Generate an image with the prompt and negative. returns the asset CBS (like {{asset::assetId}}).","This is a async function. use generateImage(triggerId, prompt, negative):await() to wait for the result."]},{"i":"llmtriggerid-data","l":"LLM(triggerId, data)","p":["This function requires low level access.","Performs a llm request with the data. returns the response.","data must be a message format, with the format of:","the response format is:","This is a async function. use LLM(triggerId, data):await() to wait for the result."]},{"i":"simplellmtriggerid-message","l":"simpleLLM(triggerId, message)","p":["This function requires low level access.","Performs a simple llm request with the message. returns the response. both the message and response format is string.","This is a async function. use simpleLLM(triggerId, message):await() to wait for the result."]},{"l":"Tips","p":["If you do not know how to write a lua script, you can refer to the lua manual or ask for help to the AI chatbot like RisuAI chat playground.","We recommend using log instead of alert or print for debugging, as it will not disturb other functions, and displays the data in a more readable format.","Every time the trigger event is triggered, the lua script will be executed from the beginning. So if you want to keep some data, you must use chat variables or state variables.","json.lua is included in the lua environment, so you can use json.encode and json.decode to serialize and deserialize JSON data.","Since the application only offers a small GUI for the lua script, we recommend using an external editor like VSCode for writing the script, and then copy and paste it to the application.","The lua script is executed in a sandbox environment, so you can't access the file system or network.","You can't use external libraries except the included json.lua."]}],[{"l":"Trigger Scripts","p":["Trigger scripts are scripts that are runs its effect when a specific event occurs and conditions are met."]}],[{"l":"Curly Braced Syntaxes","p":["Curly braced syntaxes (like {{user}}) are used to insert special values into the text. The syntaxes can be used in almost any text field in the client, including chat messages, character descriptions, and lorebook entries.","The syntaxes are replaced with the actual values when the message is sent or when the text is displayed in the client. The syntaxes can be nested and combined with other syntaxes, for example, {{calc::{{getvar::a}}+{{getvar::b}}}}.","The syntaxes are case-insensitive, so {{user}}, {{User}}, and {{USER}} are all the same. Some of the syntaxes require parameters, which are separated by ::(two colons).","Some of the syntaxes require arrays as parameters. use {{array::A::B::C...}} syntax to create an array. Some of the syntaxes are block syntaxes (like {{#if A}}), which are started with {{#NAME A}} and ended with {{/NAME}}. The block syntaxes can be nested, and starts with #. it can also be closed with {{/}} instead of {{/NAME}}. block syntaxes's content's indentation and whitespace would be trimmed, unless for some syntaxes like {{#if-pure A}} which would keep the indentation and whitespace."]},{"l":"Data Syntaxes"},{"i":"user","l":"{{user}}","p":["This will be replaced with the personas's name."]},{"i":"char","l":"{{char}}","p":["This will be replaced with the character's name. If you are chatting in a group chat, if the speaker is user, this will be replaced with group chat name. if the speaker is character, this will be replaced with the speaker's name."]},{"i":"description","l":"{{description}}","p":["Alias: {{char_desc}}","This will be replaced with the character's description."]},{"i":"example_dialogue","l":"{{example_dialogue}}","p":["Alias: {{example_message}}","This will be replaced with an array of example dialogue of the character."]},{"i":"persona","l":"{{persona}}","p":["Alias: {{user_persona}}","This will be replaced with the persona's description."]},{"i":"lorebook","l":"{{lorebook}}","p":["Alias: {{world_info}}","This will be replaced with array of lorebook entries."]},{"i":"history","l":"{{history}}","p":["Alias: {{messages}}","This will be replaced with array of messages in current chat."]},{"i":"chat_index","l":"{{chat_index}}","p":["This will be replaced with the index of the message in the chat. The chat index starts from 0 except for the first message. The first message has an index of -1. If the {{chat_index}} is used in non-chat context, it will be replaced with -1."]},{"i":"model","l":"{{model}}","p":["This will be replaced with the current model id of the client."]},{"i":"axmodel","l":"{{axmodel}}","p":["This will be replaced with the current auxiliary model id of the client."]},{"i":"role","l":"{{role}}","p":["This will be replaced with the current role of the message sender. If the {{role}} is used in non-chat context, it will be replaced with role string."]},{"i":"maxprompt","l":"{{maxprompt}}","p":["This will be replaced with the maxinum tokens setting of the client."]},{"i":"lastmessage","l":"{{lastmessage}}","p":["This will be replaced with the last message in the chat log."]},{"i":"lastmessageid","l":"{{lastmessageid}}","p":["Alias: {{lastmessageindex}}","This will be replaced with the index of the last message in the chat log."]},{"i":"previous_char_chat","l":"{{previous_char_chat}}","p":["Alias: {{lastcharmessage}}","This will be replaced with the last message of the current character in the chat log."]},{"i":"previous_user_chat","l":"{{previous_user_chat}}","p":["Alias: {{lastusermessage}}","This will be replaced with the last message of the user in the chat log."]},{"i":"previous_chat_loga","l":"{{previous_chat_log::A}}","p":["This will be replaced with the chat message with the index of A in the chat log. If the message does not exist, it will be replaced with Out of range"]},{"i":"first_msg_index","l":"{{first_msg_index}}","p":["This will be replaced with the index of the first message in the chat log."]},{"i":"screen_width","l":"{{screen_width}}","p":["This will be replaced with the width of the screen in pixels."]},{"i":"screen_height","l":"{{screen_height}}","p":["This will be replaced with the height of the screen in pixels."]},{"i":"user_history","l":"{{user_history}}","p":["This will be replaced with the array of messages of the user in the chat log."]},{"i":"char_history","l":"{{char_history}}","p":["This will be replaced with the array of messages of the character in the chat log."]},{"l":"Time Syntaxes"},{"i":"time","l":"{{time}}","p":["This will be replaced with the current time, in the format HH:MM:SS in client's timezone."]},{"i":"timea","l":"{{time::A}}","p":["A for the AM/PM indicator.","Alias: {{datetimeformat:A}}, {{date::A}}","DD for the day.","DDDD for the day count of the year.","for example, {{time::YYYY-MM-DD HH:mm:ss}} will be replaced with the current time in the format 2024-12-31 23:59:59 if the current time is 2024-12-31 23:59:59.","hh for the hour, in 12-hour format.","HH for the hour, in 24-hour format.","mm for the minute.","MM for the month.","ss for the second.","The format A can include the following:","This will be replaced with the current time, in format of A in client's timezone.","x for the unix timestamp in milliseconds.","X for the unix timestamp.","YY for the year in two digits.","YYYY for the year."]},{"i":"timeab","l":"{{time::A::B}}","p":["Alias: {{datetimeformat::A::B}}, {{date::A::B}}","Same as {{time::A}}, but the time would be in the unix timestamp B instead of the current time."]},{"i":"date","l":"{{date}}","p":["This will be replaced with the current date, in the format YYYY-MM-DD in client's timezone."]},{"i":"isotime","l":"{{isotime}}","p":["This will be replaced with the current time, in the format HH:MM:SS in the UTC timezone."]},{"i":"isodate","l":"{{isodate}}","p":["This will be replaced with the current date, in the format YYYY-MM-DD in the UTC timezone."]},{"i":"message_time","l":"{{message_time}}","p":["This will be replaced with the time when the message was sent. The returned time format would determined by the browser or OS settings.","If the {{message_time}} is used in non-chat context or the first message, it will be replaced [Cannot get time] string. If the message was sent before {{message_time}} syntax was introduced, it will be replaced with [Cannot get time, message was sent in older version] string."]},{"i":"message_date","l":"{{message_date}}","p":["This will be replaced with the date when the message was sent. The returned date format would determined by the browser or OS settings.","If the {{message_date}} is used in non-chat context or the first message, it will be replaced [Cannot get time] string. If the message was sent before {{message_date}} syntax was introduced, it will be replaced with [Cannot get time, message was sent in older version] string."]},{"i":"message_idle_duration","l":"{{message_idle_duration}}","p":["This will be replaced with the time when the user's previous message was sent subtracted by the time when the user's second previous message was sent. The returned time format would be HH:MM:SS format.","If the {{message_idle_duration}} is used in non-chat context or the first message, it will be replaced [Cannot get time] string. If the message was sent before {{message_idle_duration}} syntax was introduced, it will be replaced with [Cannot get time, message was sent in older version] string. If there are no previous messages, it will be replaced with [No user message found] string."]},{"i":"idle_duration","l":"{{idle_duration}}","p":["This will be replaced with the time when the user's previous message was sent subtracted by the current time. The returned time format would be HH:MM:SS format."]},{"i":"message_unixtime_array","l":"{{message_unixtime_array}}","p":["This will be replaced with the array of unix timestamps of the chat log."]},{"i":"emotionasset-syntaxes","l":"Emotion/Asset Syntaxes"},{"i":"asseta","l":"{{asset::A}}","p":["This will be replaced with the element with the source of the additional asset path data named A of the current character. type of the element would be determined by the asset type automatically."]},{"i":"emotiona","l":"{{emotion::A}}","p":["This will be replaced with the image element with the source of the emotion image path data named A of the current character."]},{"i":"audioa","l":"{{audio::A}}","p":["This will be replaced with the audio element with the source of the additional asset path data named A of the current character."]},{"i":"bga","l":"{{bg::A}}","p":["This will be replaced with the background image element with the source of the additional asset path data named A of the current character."]},{"i":"videoa","l":"{{video::A}}","p":["This will be replaced with the video element with the source of the additional asset path data named A of the current character."]},{"i":"video-imga","l":"{{video-img::A}}","p":["This will be replaced with the video element with the source of the additional asset path data named A of the current character. unlike {{video::A}}, the element would be displayed like an image element."]},{"i":"rawa","l":"{{raw::A}}","p":["This will be replaced with additional asset path data named A of the current character."]},{"i":"imga","l":"{{img::A}}","p":["This will be replaced with the image element with the source of the additional asset path data named A of the current character."]},{"i":"assetlist","l":"{{assetlist}}","p":["This will be replaced with the array of names of additional assets of the current character."]},{"i":"emotionlist","l":"{{emotionlist}}","p":["This will be replaced with the array of names of emotion images of the current character."]},{"i":"mathcondition-syntaxes","l":"Math/Condition Syntaxes"},{"i":"-a","l":"{{? A}}","p":["!A for not A.","= for ==","| for ||","≤ for =","≥ for =","$name for getting the value of the chat variable named name. name should be named with only alphanumeric characters and underscore.","A-B for subtraction of B from A.","A!=B for A is not equal to B.","A*B for multiplication of A and B.","A/B for division of A by B.","A%B for remainder of the division of A by B.","A^B for A raised to the power of B.","A+B for addition of A and B.","A==B for A is equal to B.","A=B for A is greater than or equal to B.","A=B for A is less than or equal to B.","A||B for A or B.","AB for A and B.","AB for A is greater than B.","AB for A is less than B.","Alias: {{calc::A}}","for","Some of the syntaxes has aliases:","The boolean values are represented as 1 for true and 0 for false. Note that {{? A}} syntax is only for numeric and boolean values. for string values, use other syntaxes like {{equal::A::B}}.","These are the supported operators and functions:","This will be replaced with the result of the calculation of the provided expression A. for example, {{? 5+3}} will be replaced with 8. You can nest other syntaxes in the expression."]},{"i":"equalab","l":"{{equal::A::B}}","p":["This will be replaced with 1 if A is equal to B, otherwise it will be replaced with 0. unlike {{? A}}, this syntax works for any type of values."]},{"i":"not_equalab","l":"{{not_equal::A::B}}","p":["Alias: {{notequal::A::B}}","This will be replaced with 1 if A is not equal to B, otherwise it will be replaced with 0. unlike {{? A}}, this syntax works for any type of values."]},{"i":"floora","l":"{{floor::A}}","p":["This will be replaced with the largest integer less than or equal to A."]},{"i":"ceila","l":"{{ceil::A}}","p":["This will be replaced with the smallest integer greater than or equal to A."]},{"i":"absa","l":"{{abs::A}}","p":["This will be replaced with the absolute value of A."]},{"i":"startswithab","l":"{{startswith::A::B}}","p":["This will be replaced with 1 if A starts with B, otherwise it will be replaced with 0."]},{"i":"endswithab","l":"{{endswith::A::B}}","p":["This will be replaced with 1 if A ends with B, otherwise it will be replaced with 0."]},{"i":"containsab","l":"{{contains::A::B}}","p":["This will be replaced with 1 if A contains B, otherwise it will be replaced with 0."]},{"i":"prefill_supported","l":"{{prefill_supported}}","p":["This will be replaced with 1 if the model supports prefilling, otherwise it will be replaced with 0."]},{"i":"lowera","l":"{{lower::A}}","p":["This will be replaced with A converted to lowercase."]},{"i":"uppera","l":"{{upper::A}}","p":["This will be replaced with A converted to uppercase."]},{"i":"capitalizea","l":"{{capitalize::A}}","p":["This will be replaced with A with the first letter capitalized."]},{"i":"rounda","l":"{{round::A}}","p":["This will be replaced with A rounded to the nearest integer."]},{"i":"trima","l":"{{trim::A}}","p":["This will be replaced with A with leading and trailing whitespaces removed."]},{"i":"jbtoggled","l":"{{jbtoggled}}","p":["This will be replaced with the current state of the jailbreak toggle. If jailbreak is enabled, it will be replaced with 1, otherwise it will be replaced with 0."]},{"l":"Variable Syntaxes"},{"i":"getvara","l":"{{getvar::A}}","p":["This will be replaced with the value of the chat variable A. If the chat variable A is not defined, it will be replaced with null."]},{"i":"setvarab","l":"{{setvar::A::B}}","p":["This will set the chat variable A to B and be replaced with an empty string. {{setvar::A::B}} only works when it is in the chat context and it is not the first message.","If its possible, it is recommended to use trigger script instead of this syntax."]},{"i":"addvarab","l":"{{addvar::A::B}}","p":["This will increment the chat variable A by B and be replaced with an empty string. for example, if variable A is 5 and {{addvar::A::3}} is used, the variable A will be 8. {{addvar::A::B}} only works when it is in the chat context and it is not the first message."]},{"i":"getglobalvara","l":"{{getglobalvar::A}}","p":["This will be replaced with the value of the global variable A. If the global variable A is not defined, it will be replaced with null."]},{"l":"Array Syntaxes"},{"i":"arrayabc","l":"{{array::A::B::C...}}","p":["This will be replaced with an array of B, C, and so on. This can be used to create an array from multiple parameters.","Currently array uses § as separator, but this might change in the future. so it is recommended to use this syntax instead of using § directly."]},{"i":"array_lengtha","l":"{{array_length::A}}","p":["Alias: {{arraylength::A}}","This will be replaced with the length of array A. this would not work with strings."]},{"i":"array_elementab","l":"{{array_element::A::B}}","p":["This will be replaced with the element of array A at index B. index starts from 0. if the index is out of range, it will be replaced with null. if index is negative, it will be counted from the end of the array."]},{"i":"array_pushab","l":"{{array_push::A::B}}","p":["This will be replaced with array A with element B pushed to the end."]},{"i":"array_popa","l":"{{array_pop::A}}","p":["This will be replaced with array A with the last element removed."]},{"i":"array_shifta","l":"{{array_shift::A}}","p":["This will be replaced with array A with the first element removed."]},{"i":"array_spliceabcd","l":"{{array_splice::A::B::C::D...}}","p":["This will be replaced with array A with C, D, and so on inserted at index B."]},{"i":"splitab","l":"{{split::A::B}}","p":["This will be replaced with an array of strings that are separated by B in A."]},{"i":"joinab","l":"{{join::A::B}}","p":["This will be replaced with a string that is created by joining the elements of array A with B."]},{"l":"Utility Syntaxes"},{"i":"slot","l":"{{slot}}","p":["If it is used in prompt template, pipeline or translator prompt, it will be replaced to original slot content. otherwise, it will not be replaced."]},{"i":"slota","l":"{{slot::A}}","p":["If it is used in {{#each C D}} block, and if D is same as A, it will be replaced to the current element of the array. otherwise, it will not be replaced."]},{"i":"positiona","l":"{{position::A}}","p":["If it is used in prompt template, it will be replaced to the lorebooks that uses position pt_A like pt_personality. if the corresponding lorebook does not exist, it will be replaced with an empty string. otherwise, it will not be replaced."]},{"i":"randomab","l":"{{random::A::B...}}","p":["Alias: {{random:A,B...}}","This will be replaced with a random value from the provided parameters. for example, {{random::A::B::C}} will be replaced with either A, B, or C. If no parameters are provided, it will be replaced with random number between 0 and 1."]},{"i":"pickab","l":"{{pick::A::B...}}","p":["Alias: {{pick:A,B...}}","This would work same as {{random::A::B...}}, except the seed would be the same for the same message which would make the result consistent. This also doesn't work with no parameters."]},{"i":"rolla","l":"{{roll::A}}","p":["Alias: {{roll:A}}","This will be replaced with a random number between 1 and A. if A starts with d, it will be replaced with a random number between 1 and A without the d."]},{"i":"rollpa","l":"{{rollp::A}}","p":["Alias: {{rollp:A}}","This would work same as {{roll::A}}, except the seed would be the same for the same message which would make the result consistent."]},{"i":"spreada","l":"{{spread::A}}","p":["This will be replaced with a a string created by joining the elements of array A with ::(two colons). This can be used to make multi-parameter syntaxes from arrays. For example, {{random::{{spread::{{array::chicken::pizza::hamburger}}}}}} will act same as {{random::chicken::pizza::hamburger}}."]},{"i":"replaceabc","l":"{{replace::A::B::C}}","p":["This will be replaced with A with all occurrences of B replaced with C."]},{"i":"rangea","l":"{{range::A}}","p":["This will be replaced with an array of numbers from 0 to A- 1."]},{"i":"lengtha","l":"{{length::A}}","p":["This will be replaced with the length of A. this would not work with arrays."]},{"i":"none","l":"{{none}}","p":["Alias: {{blank}}","This will be replaced with an empty string. Useful for removing the default text.","If its used in first message, the first message will work as if it not exists."]},{"i":"br","l":"{{br}}","p":["Alias: {{newline}}","This will be replaced with a line break."]},{"i":"tonumbera","l":"{{tonumber::A}}","p":["This would trim all non-numeric characters except for .. This doesn't guarantee that the result is a valid number."]},{"l":"Block Syntaxes"},{"i":"if-a","l":"{{#if A}}","p":["This will be replaced with the content if A is 1, otherwise it will be replaced with an empty string.","Example:"]},{"i":"if-pure-a","l":"{{#if-pure A}}","p":["Same as {{#if A}}, but it would keep the indentation and whitespace of the content."]},{"i":"each-a-b","l":"{{#each A B}}","p":["This will be replaced with the content for each element of the array A. The current element of the array will be replaced with B.","Example:","will be replaced with"]},{"l":"Unrecommended Syntaxes","p":["Unrecommended syntaxes are deprecated. They are still functional, but they might not work as expected, and might be removed in the future updates.","Please use the recommended syntaxes instead."]},{"i":"user-1","l":"user","p":["Works the same as {{user}}. Deprecated due to inconsistency in naming, and syntax conflict. Use {{user}} instead.","Dude to syntax conflict, this syntax might not work as expected."]},{"l":"bot","p":["Alias: char","Works the same as {{char}}. Deprecated due to inconsistency in naming, and syntax conflict. Use {{char}} instead.","Dude to syntax conflict, this syntax might not work as expected."]},{"i":"main_prompt","l":"{{main_prompt}}","p":["Alias: {{system_prompt}}","This will be replaced with the main prompt of the prompt setting. Deprecated due to incompiatibility with the prompt template system."]},{"i":"global_note","l":"{{global_note}}","p":["Alias: {{ujb}}, {{system_note}}","This will be replaced with the global_note of the prompt setting. Deprecated due to incompiatibility with the prompt template system."]},{"i":"personality","l":"{{personality}}","p":["Alias: {{char_persona}}","This will be replaced with the character's personality description. Deprecated due to deprecation of personality description."]},{"i":"scenario","l":"{{scenario}}","p":["This will be replaced with the character's scenario description. Deprecated due to deprecation of scenario description."]},{"i":"if-a-b-","l":"{#if A B #}","p":["This will be replaced with the content if A is equal to B, otherwise it will be replaced with an empty string. Deprecated due to introduction of blocked {{#if A}} syntax.","Use {{#if A}} {{/if}} block syntax instead."]},{"i":"remaindab","l":"{{remaind::A::B}}","p":["This will be replaced with the remainder of the division of A by B.","Deprecated due to upgrade of {{? A}} syntax. use {{calc::A%B}} or {{? A%B}} instead."]},{"i":"greaterab","l":"{{greater::A::B}}","p":["This will be replaced with 1 if A is greater than B, otherwise it will be replaced with 0.","Deprecated due to upgrade of {{? A}} syntax. use {{calc::AB}} or {{? AB}} instead."]},{"i":"greater_equalab","l":"{{greater_equal::A::B}}","p":["Alias: {{greaterequal::A::B}}","This will be replaced with 1 if A is greater than or equal to B, otherwise it will be replaced with 0.","Deprecated due to upgrade of {{? A}} syntax. use {{calc::A=B}} or {{? A=B}} instead."]},{"i":"lessab","l":"{{less::A::B}}","p":["This will be replaced with 1 if A is less than B, otherwise it will be replaced with 0.","Deprecated due to upgrade of {{? A}} syntax. use {{calc::AB}} or {{? AB}} instead."]},{"i":"less_equalab","l":"{{less_equal::A::B}}","p":["Alias: {{lessequal::A::B}}","This will be replaced with 1 if A is less than or equal to B, otherwise it will be replaced with 0.","Deprecated due to upgrade of {{? A}} syntax. use {{calc::A=B}} or {{? A=B}} instead."]},{"i":"andab","l":"{{and::A::B}}","p":["This will be replaced with 1 if A and B are both 1, otherwise it will be replaced with 0.","Deprecated due to upgrade of {{? A}} syntax. use {{calc::AB}} or {{? AB}} instead."]},{"i":"orab","l":"{{or::A::B}}","p":["This will be replaced with 1 if A or B is 1, otherwise it will be replaced with 0.","Deprecated due to upgrade of {{? A}} syntax. use {{calc::A||B}} or {{? A||B}} instead."]},{"i":"powab","l":"{{pow::A::B}}","p":["This will be replaced with A raised to the power of B.","Deprecated due to upgrade of {{? A}} syntax. use {{calc::A^B}} or {{? A^B}} instead."]},{"i":"nota","l":"{{not::A}}","p":["This will be replaced with 1 if A is 0, otherwise it will be replaced with 0.","Deprecated due to upgrade of {{? A}} syntax. use {{calc::!A}} or {{? !A}} instead."]}],[{"l":"HTML in RisuAI","p":["RisuAI supports inserting HTML tags (like b, i, a, etc.) in the text. This is useful for formatting the text in a more advanced way.","Example:","Some tags and attributes are treated specially:","style: The css inside this tag would be trimmed down to a safe subset of css properties and values. and class names would be renamed to prevent conflicts.","iframe: If is a youtube video, it would be embedded in the chat. Otherwise, it would be removed.","class attribute: The class names would be renamed to prevent conflicts. since the css's class names are renamed, the class names in the HTML tags would still work.","href attribute: The attribute would be removed if it is not a valid URL.","translate attribute: If the attribute is set to no, the element won't be translated.","risu-trigger attribute: If the attribute is set, if the user clicks on the element, the trigger named in the attribute would be triggered.","RisuAI also adds some new XML tags:","Comment: This tag is used to insert comments in the text. The text inside this tag would be hidden for both the user and the AI.","Thoughts: This tag is used to insert thoughts of AI in the text. The text inside would be hidden for the user but would be used by the AI to generate the response.","the HTML tags are trimed down to a safe subset of tags and attributes to prevent XSS attacks."]}],[{"l":"Markdown","p":["Markdown is a markup language with plain text formatting syntax. Its used to style text on the many applications including RisuAI."]},{"l":"Supported","p":["- [x] Task 1- [ ] Task 2","- First item- Second item","---","(Not displayed on Docs)","[text](url)","**bold text**","*italic text*","# Heading 1## Heading 2### Heading 3","`code`","| Header 1 | Header 2 || ----------- | ----------- || Element 1 | Element 2 |","~~strikethrough text~~","1. First item 2. Second item","Bold","bold text","Code","Element","Heading","Horizontal Rule","Italic","italic text","Link","Ordered List","Output","Strikethrough","strikethrough text","Syntax","Table","Task List","text","Unordered List"]}]]